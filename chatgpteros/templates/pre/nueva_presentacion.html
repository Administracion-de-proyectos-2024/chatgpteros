<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nueva Presentación</title>
</head>
<body>
    <h1>Nueva Presentación</h1>
    <form id="presentation-form" method="post">
        {% csrf_token %}
        {{ presentacion_form.as_p }}
        <fieldset id="diapositivas">
            <legend>Diapositivas</legend>
            {{ diapositiva_formset.management_form }}
            <div id="formset-container">
                {% for form in diapositiva_formset %}
                    <div class="formset-row" id="formset-row-{{ forloop.counter0 }}">
                        {{ form.as_p }}
                        <!-- Omitir el campo "Eliminar" -->
                    </div>
                {% endfor %}
            </div>
            <!-- Mover el botón dentro del fieldset -->
            <button type="button" id="agregar-diapositiva">Agregar Diapositiva</button>
        </fieldset>
        <button type="submit">Guardar</button>
    </form>

    <input type="hidden" id="id_form-TOTAL_FORMS" name="form-TOTAL_FORMS" value="{{ diapositiva_formset.total_form_count }}">

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var addButton = document.getElementById('agregar-diapositiva');
            var formset = document.getElementById('formset-container');
            var totalForms = document.getElementById('id_diapositiva_set-TOTAL_FORMS');

            addButton.addEventListener('click', function() {
                var formIndex = parseInt(totalForms.value); // Obtener el índice actual del formulario

                // Crear un nuevo formulario de diapositivas
                var newForm = document.createElement('div');
                newForm.className = 'formset-row';
                newForm.innerHTML = `
                    <p><label for="id_diapositiva_set-${formIndex}-contenido">Contenido:</label> <textarea id="id_diapositiva_set-${formIndex}-contenido" name="diapositiva_set-${formIndex}-contenido"></textarea></p>
                    <!-- Agrega aquí cualquier otro campo que necesites en tu formulario de diapositivas -->
                `;

                formset.appendChild(newForm); // Agregar el nuevo formulario al DOM

                formIndex++;
                totalForms.setAttribute('value', formIndex); // Actualizar el valor del contador de formularios
            });
        });

    </script>
        
</body>
</html>
